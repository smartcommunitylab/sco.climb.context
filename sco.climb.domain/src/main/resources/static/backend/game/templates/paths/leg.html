<div class="row">
    <div class="col-md-8 header-path-category">
        <h4>{{leg.name ? 'MODIFICA TAPPA: ' + leg.name : 'CREA NUOVA TAPPA'}}</h4>
        <p>I campi contrassegnati col simbolo <span class="required-sign">*</span> sono obbligatori</p>
    </div>

    <div class="col-md-4 right">
        <a ng-click="save()" class="btn btn-save btn-margin" role="button">Salva tappa</a>
        <a ng-click="back()" class="btn btn-danger" role="button">Annulla</a>
    </div>


    <div class="col-lg-12 field">
        <p><span class="required-sign">*</span> <b>Nome:</b></p>
        <input ng-class="{error: !leg.name}" class="form-control" type="text" ng-model="leg.name" />
    </div>
    <div class="col-lg-12 field">
        <p><span class="required-sign">*</span> <b>Descrizione:</b></p>
        <text-angular ng-class="{error: !leg.description}" ng-model="leg.description"></text-angular>
    </div>
    <div class="col-lg-12 field">
        <p><span class="required-sign">*</span> <b>Punteggio:</b></p>
        <input ng-class="{error: !leg.score}" class="form-control" type="number" min="0" ng-model="leg.score" />
    </div>
    <div class="col-lg-12 field">
        <p><b>Badge:</b></p>
        <input class="form-control" type="text" ng-model="leg.badgeId" />
    </div>    
    <div style="display: table; margin-bottom: 10px;">
        <div class="col-lg-5 field" style="display: table-cell">
            <p><span class="required-sign">*</span> <b>Immagine in evidenza (URL):</b></p>
            <input type="url" ng-class="{error: !leg.imageUrl}" ng-model="leg.imageUrl" class="form-control" style="margin-left: 8px;" />
        </div>

        <div class="col-lg-7 field add-media" style="display: table-cell; margin-top: 15px;">
            <p><b>oppure caricala su <a href="http://www.imgur.com" target="_blank">imgur</a>:</b> {{img.filename ? img.filename : 'Nessun file selezionato'}}</p>
            <span class="btn btn-info btn-file btn-margin">
                Scegli file <input type="file" base-sixty-four-input ng-model="img" accept="image/*" />
            </span>
            <a ng-disabled="!img" ng-click="!img || uploadFeaturedPic(img)" class="btn btn-info">Carica</a>
        </div>
    </div>
    <div class="col-md-12 field" ng-if="leg.position > 0">
        <p><b>Mezzo di arrivo:</b></p>
        <select class="form-control" style="width: 200px" ng-model="leg.transport" ng-change="updateTravelType(leg.transport)">
            <option value="foot">A piedi</option>
            <option value="plane">Aereo</option>
            <option value="boat">Nave/Traghetto</option>
        </select>
    </div>
</div>
<div class="row">
    <div class="col-md-5">
        <div class="row">
            <div class="col-lg-12 field">
                <div class="coordinates-label">
                    <p><span class="required-sign">*</span> <b>Latitudine:</b></p>
                </div>
                <input ng-blur="updateMarkerPosition()" ng-class="{error: !leg.coordinates.lat}" class="form-control coordinates-input" type="number" ng-model="leg.coordinates.lat" />
            </div>
            <div class="col-lg-12 field">
                <div class="coordinates-label">
                    <p><span class="required-sign">*</span> <b>Longitudine:</b></p>
                </div>
                <input ng-blur="updateMarkerPosition()" ng-class="{error: !leg.coordinates.lng}" class="form-control coordinates-input" type="number" ng-model="leg.coordinates.lng" />
            </div>
            <div class="col-lg-12 field" ng-show="leg.transport !== 'foot'" ng-init="distance = ''">
                <div class="coordinates-label">
                    <p><b>Lunghezza linea (km):</b></p>
                </div>
                <input id="airDistance" ng-blur="calculateNewMarkerPos(distance)" class="form-control coordinates-input" type="number" ng-model="distance"/>
            </div>
            <div class="col-lg-12">
                <p class="hint">Suggerimento: trascina il segnaposto rosso o inserisci le coordinate geografiche in base decimale per impostare la posizione della tappa. Verrà calcolato l'itinerario a piedi con partenza dalla tappa precedente.<br>
                Se la destinazione non è raggiungibile a piedi, seleziona un mezzo di arrivo adeguato.</p>
                <p ng-if="leg.transport !== 'foot'" class="hint">In alternativa, puoi anche impostare la lunghezza in chilometri della linea retta nel campo di testo qui sopra.</p>
            </div>
        </div>
    </div>
    <div class="col-md-7">
        <div id="map-leg"></div>
    </div>
</div>

<div class="row leg-media">
    <div class="col-md-12 field add-media">
        <p><b>Aggiungi un nuovo elemento multimediale</b></p>
    </div>
    <!-- Media type -->
    <div class="col-md-12 field add-media">
        <div class="add-media-label">
            <p><b>Tipologia:</b></p>
        </div>
        <select class="form-control" ng-model="newMedia.type">
            <option value="image">Immagine</option>
            <option value="video">Video</option>
            <option value="link">Collegamento a pagina web</option>
        </select>
    </div>
    <!-- Media name -->
    <div class="col-lg-12 field add-media">
        <div class="add-media-label">
            <p><b>Titolo:</b></p>
        </div>
        <input class="form-control" type="text" ng-model="newMedia.name" />
    </div>
    <!-- Media link -->
    <div class="col-lg-12 field add-media">
        <div class="add-media-label">
            <p><b>URL:</b> <span class="required-sign">*</span></p>
        </div>
        <input type="url" class="form-control" ng-model="newMedia.link" required/>
    </div>

    <!-- Upload pic on imgur -->
    <div class="col-lg-12" ng-show="newMedia.type == 'image'">
        <div class="field add-media">
            <p>oppure</p>
        </div>
        <div class="field add-media">
            <p><b>Carica immagine su <a href="http://www.imgur.com" target="_blank">imgur</a>:</b> {{file.filename ? file.filename : 'Nessun file selezionato'}}</p>
            <span class="btn btn-info btn-file btn-margin">
            Scegli file <input type="file" base-sixty-four-input ng-model="file" accept="image/*" />
            </span>
            <a ng-disabled="!file" ng-click="!file || uploadPic(file)" class="btn btn-info">Carica</a>
        </div>
    </div>
    <div class="col-lg-12 field add-media">
        <a ng-click="addMedia()" class="btn btn-info" role="button">Aggiungi elemento</a>
    </div>

    <!-- Divider -->
    <div class="col-lg-12 field add-media">
        <hr />
    </div>

    <!-- List of available media -->
    <div class="col-lg-12 right">
        <a class="btn btn-info" ng-click="enableOrder = !enableOrder">{{enableOrder ? 'Conferma ordine' : 'Riordina elementi'}}</a>
    </div>

    <div class="col-lg-12 media-type-title">
        <p>MULTIMEDIA ({{leg.externalUrls.length}})</p>
    </div>
    <div class="col-lg-12">
        <ul ui-sortable="sortableOptions" ng-model="leg.externalUrls" class="list-group list-categories">
            <li class="list-group-item" ng-repeat="element in leg.externalUrls">
                <div class="row v-center" ng-init="editMode = false">
                    <div class="col-md-2">
                        <img class="path-img" ng-if="element.type == 'image'" ng-src="{{element.link}}" alt="{{element.name}}">
                        <img class="path-img" ng-if="element.type == 'video'" src="img/video.png" alt="Video">
                        <img class="path-img" ng-if="element.type == 'link'" src="img/link.png" alt="Link">
                    </div>
                    <div class="col-md-10" ng-if="editMode == false" ng-include="'templates/paths/media/show.html'">
                    </div>
                    <div class="col-md-10" ng-if="editMode == true" ng-include="'templates/paths/media/edit.html'">
                    </div>
                </div>
            </li>
        </ul>
    </div>

</div>